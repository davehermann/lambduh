<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Initial AWS Configuration: Manual | Lamb-duh</title>
    <meta name="description" content="Stupid name. Stupidly simple serverless deployment to AWS.">
    
    
    <link rel="preload" href="/lambduh/assets/css/0.styles.f1942610.css" as="style"><link rel="preload" href="/lambduh/assets/js/app.ff34b4b2.js" as="script"><link rel="preload" href="/lambduh/assets/js/9.48086f72.js" as="script"><link rel="prefetch" href="/lambduh/assets/js/10.af54ed86.js"><link rel="prefetch" href="/lambduh/assets/js/11.bc5dc81a.js"><link rel="prefetch" href="/lambduh/assets/js/12.96673b64.js"><link rel="prefetch" href="/lambduh/assets/js/2.ae4252f2.js"><link rel="prefetch" href="/lambduh/assets/js/3.a35d3ce9.js"><link rel="prefetch" href="/lambduh/assets/js/4.52bb3f99.js"><link rel="prefetch" href="/lambduh/assets/js/5.6bcd0b2f.js"><link rel="prefetch" href="/lambduh/assets/js/6.4115ba85.js"><link rel="prefetch" href="/lambduh/assets/js/7.bdaf11db.js"><link rel="prefetch" href="/lambduh/assets/js/8.64188126.js">
    <link rel="stylesheet" href="/lambduh/assets/css/0.styles.f1942610.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/lambduh/" class="home-link router-link-active"><!----> <span class="site-name">Lamb-duh</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/davehermann/lambduh" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/davehermann/lambduh" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/lambduh/" class="sidebar-link">Lamb-duh</a></li><li><a href="/lambduh/GettingStarted.html" class="sidebar-link">Getting Started</a></li><li><a href="/lambduh/ManualConfiguration.html" class="active sidebar-link">Initial AWS Configuration: Manual</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/lambduh/ManualConfiguration.html#iam-configuration" class="sidebar-link">IAM Configuration</a></li><li class="sidebar-sub-header"><a href="/lambduh/ManualConfiguration.html#lambda-configuration" class="sidebar-link">Lambda Configuration</a></li><li class="sidebar-sub-header"><a href="/lambduh/ManualConfiguration.html#optional-add-tags" class="sidebar-link">Optional: Add Tags</a></li></ul></li><li><a href="/lambduh/LambdaEnvironment.html" class="sidebar-link">Lamb-duh Runtime Options in AWS Lambda</a></li><li><a href="/lambduh/LambduhConfiguration.html" class="sidebar-link">Application Deployment Configuration</a></li><li><a href="/lambduh/ExampleDeployment.html" class="sidebar-link">Example Deployment</a></li><li><a href="/lambduh/CLI.html" class="sidebar-link">Lamb-duh CLI Application</a></li><li><a href="/lambduh/UpgradeToV2.html" class="sidebar-link">v1 to v2 Migration</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="initial-aws-configuration-manual"><a href="#initial-aws-configuration-manual" aria-hidden="true" class="header-anchor">#</a> Initial AWS Configuration: Manual</h1> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>For this documentation, use of the AWS Console is assumed.</p></div> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>The names used (IAM role name, Lambda function name, etc.) will match the default names used by the CLI.</p></div> <p></p><div class="table-of-contents"><ul><li><a href="#iam-configuration">IAM Configuration</a><ul><li><a href="#create-a-new-role">Create a new role</a></li><li><a href="#attach-inline-policies">Attach Inline Policies</a><ul><li><a href="#api-gateway-management">APIGatewayManagement</a></li><li><a href="#cloudwatch-logs">Cloudwatch_Logs</a></li><li><a href="#lambda-management">Lambda_Management</a></li><li><a href="#s3-trigger-bucket">S3TriggerBucket</a></li><li><a href="#sns-reporting-optional">SNS_Reporting (optional)</a></li></ul></li><li><a href="#additional-policy-needed-for-u-each-u-s3-bucket-manipulated-by-a-deployment">Additional policy needed for <u>each</u> S3 bucket manipulated by a deployment</a><ul><li><a href="#s3-write-to-your-destination-bucket-name">S3Writeto_YOUR-DESTINATION-BUCKET-NAME</a></li></ul></li></ul></li><li><a href="#lambda-configuration">Lambda Configuration</a><ul><li><a href="#create-a-new-function">Create a new function</a></li><li><a href="#configure-function">Configure Function</a></li><li><a href="#add-trigger-to-function">Add Trigger to Function</a></li></ul></li><li><a href="#optional-add-tags">Optional: Add Tags</a></li></ul></div><p></p> <h2 id="iam-configuration"><a href="#iam-configuration" aria-hidden="true" class="header-anchor">#</a> IAM Configuration</h2> <h3 id="create-a-new-role"><a href="#create-a-new-role" aria-hidden="true" class="header-anchor">#</a> Create a new role</h3> <ul><li>This will be a service role with the role type of <em>Lambda</em></li> <li>Do not attach any policies at this step</li> <li>Add a tag with the <em>key</em> of <strong>Lamb-duh Resource</strong> and a <em>value</em> of <strong>true</strong></li> <li><em>Role Name:</em> <strong>Lamb-duh_Deployment</strong></li> <li><em>Description:</em> <strong>Lamb-duh role for deploying applications</strong></li></ul> <h3 id="attach-inline-policies"><a href="#attach-inline-policies" aria-hidden="true" class="header-anchor">#</a> Attach Inline Policies</h3> <p>This role is going to have five inline policies attached.
The policies below are the JSON for the <strong>Statement</strong> block.</p> <div class="tip custom-block"><p class="custom-block-title">ARNs</p> <p>The Resource ARN fields can be as specific as warranted</p></div> <h4 id="api-gateway-management"><a href="#api-gateway-management" aria-hidden="true" class="header-anchor">#</a> API_Gateway_Management</h4> <p>Manage API Gateway endpoints, stages, and deployments.</p> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;apigateway:DELETE&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;apigateway:GET&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;apigateway:PATCH&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;apigateway:POST&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;apigateway:PUT&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;arn:aws:apigateway:*::/*&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
</code></pre></div><h4 id="cloudwatch-logs"><a href="#cloudwatch-logs" aria-hidden="true" class="header-anchor">#</a> Cloudwatch_Logs</h4> <p>This is needed by all AWS Lambda functions to allow logging</p> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;logs:CreateLogGroup&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;logs:CreateLogStream&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;logs:PutLogEvents&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;arn:aws:logs:*:*:*&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
</code></pre></div><h4 id="lambda-management"><a href="#lambda-management" aria-hidden="true" class="header-anchor">#</a> Lambda_Management</h4> <p>Create, update, and version Lambda functions</p> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;iam:PassRole&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:CreateAlias&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:CreateFunction&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:DeleteAlias&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:DeleteFunction&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:GetFunctionConfiguration&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:GetPolicy&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:ListAliases&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:ListFunctions&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:ListVersionsByFunction&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:PublishVersion&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:RemovePermission&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:UpdateAlias&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:UpdateFunctionCode&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:UpdateFunctionConfiguration&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;lambda:AddPermission&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;*&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
</code></pre></div><h4 id="s3-trigger-bucket"><a href="#s3-trigger-bucket" aria-hidden="true" class="header-anchor">#</a> S3_Trigger_Bucket</h4> <p>Where your compressed application archive is placed to start the Lamb-duh deployment process</p> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;s3:ListBucket&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;arn:aws:s3:::YOUR-TRIGGERING-BUCKET-NAME&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;s3:DeleteObject&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;s3:GetObject&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;s3:PutObject&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;arn:aws:s3:::YOUR-TRIGGERING-BUCKET-NAME/*&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
</code></pre></div><h4 id="sns-reporting-optional"><a href="#sns-reporting-optional" aria-hidden="true" class="header-anchor">#</a> SNS_Reporting (optional)</h4> <p>If you want notifications sent via SNS topics</p> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sns:Publish&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;arn:aws:sns:*:*:*&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
</code></pre></div><h3 id="additional-policy-needed-for-each-s3-bucket-manipulated-by-a-deployment"><a href="#additional-policy-needed-for-each-s3-bucket-manipulated-by-a-deployment" aria-hidden="true" class="header-anchor">#</a> Additional policy needed for <u>each</u> S3 bucket manipulated by a deployment</h3> <p>Each S3 task in an application configuration will overwrite the contents of a bucket-key (prefix)</p> <h4 id="s3-write-to-your-destination-bucket-name"><a href="#s3-write-to-your-destination-bucket-name" aria-hidden="true" class="header-anchor">#</a> S3_Write_to_YOUR-DESTINATION-BUCKET-NAME</h4> <div class="language-json extra-class"><pre class="language-json"><code>    <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;s3:ListBucket&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;arn:aws:s3:::YOUR-DESTINATION-BUCKET-NAME&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;Effect&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Allow&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Action&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;s3:DeleteObject&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;s3:PutObject&quot;</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token property">&quot;Resource&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;arn:aws:s3:::YOUR-DESTINATION-BUCKET-NAME/*&quot;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
</code></pre></div><h2 id="lambda-configuration"><a href="#lambda-configuration" aria-hidden="true" class="header-anchor">#</a> Lambda Configuration</h2> <h3 id="create-a-new-function"><a href="#create-a-new-function" aria-hidden="true" class="header-anchor">#</a> Create a new function</h3> <ul><li>From scratch</li> <li><em>Name:</em> <strong>Lambduh_Deployment</strong></li> <li><em>Runtime:</em> <strong>Node.js 8.10</strong></li> <li><em>Existing Role:</em> <strong>Lamb-duh_Deployment</strong></li></ul> <h3 id="configure-function"><a href="#configure-function" aria-hidden="true" class="header-anchor">#</a> Configure Function</h3> <ul><li>Upload the <code>./Lambda Deployment Package.zip</code> file</li> <li><em>Handler:</em> <strong>deploy.lambda</strong></li> <li><em>Memory Size:</em> <strong>2048 MB</strong> (or greater)</li> <li><em>Timeout:</em> <strong>2 minutes</strong> (or greater)</li></ul> <div class="warning custom-block"><p class="custom-block-title">Memory and Timeout</p> <p>If you experience any issues with the process timing out during a deployment, <strong>increase</strong> either the <em>Memory Size</em> or the <em>Timeout</em> period, or both.</p></div> <h3 id="add-trigger-to-function"><a href="#add-trigger-to-function" aria-hidden="true" class="header-anchor">#</a> Add Trigger to Function</h3> <ul><li>Add S3 trigger for compressed archive
<ul><li>For your trigger bucket</li> <li>All object create events</li> <li><em>Suffix:</em> <strong>.zip</strong> <ul><li>Use <strong>.tar.gz</strong> if you prefer, or create a second trigger to handle both</li></ul></li></ul></li> <li>Add S3 trigger for Lamb-duh continuing deployment
<ul><li>For your trigger bucket</li> <li>All object create events</li> <li><em>Suffix:</em> <strong>.lambduh.txt</strong></li></ul></li></ul> <h2 id="optional-add-tags"><a href="#optional-add-tags" aria-hidden="true" class="header-anchor">#</a> Optional: Add Tags</h2> <p>For both the function in Lambda, and the IAM role:</p> <ul><li>Add a tag
<ul><li><em>Key:</em> <strong>Lamb-duh Resource</strong></li> <li><em>Value:</em> <strong>true</strong></li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">Why Tag?</p> <p>Tags are used by the CLI utility to more efficiently work with resources</p></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/lambduh/GettingStarted.html" class="prev">
          Getting Started
        </a></span> <span class="next"><a href="/lambduh/LambdaEnvironment.html">
          Lamb-duh Runtime Options in AWS Lambda
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/lambduh/assets/js/app.ff34b4b2.js" defer></script><script src="/lambduh/assets/js/9.48086f72.js" defer></script>
  </body>
</html>
